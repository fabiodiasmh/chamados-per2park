import{aT as h}from"./index-MSiwPzFN.js";import{a,u}from"./auth-dynkwFMp.js";const m=h("chamados",{state:()=>({chamados:[],detalhe_chamado:{},chamadosPorStatus:{},topLocais:[],retorno_status:[],loading:!1,error:null}),actions:{async atualizarStatusNoStore(o,e){var c,n,l,i;const s=u();if(!((c=this.detalhe_chamado)!=null&&c.Id))return console.error("ID do chamado ausente!",this.detalhe_chamado),{success:!1,message:"Chamado inválido: ID não encontrado"};if(!((n=s.usuario)!=null&&n.Id))return console.error("Usuário sem ID!",s.usuario),{success:!1,message:"Usuário não autenticado corretamente"};const r={...this.detalhe_chamado,Status:o,User:{...s.usuario},Description:e,DescriptionUser:e,HistoryCalls:[]};console.log("Payload para atualização:",r),this.loading=!0,this.error=null;try{console.log("Fetching chamados...");const t=await a.put("/update_chamado",r);return console.log("PUT update chamado:",r),{data:t.data}}catch(t){return this.error=((i=(l=t.response)==null?void 0:l.data)==null?void 0:i.message)||"Erro ao buscar chamados",console.error("Error fetching chamados:",t),console.error("Error response:",t.response),{message:this.error}}finally{this.loading=!1}},async fetchChamados(){var o,e;this.loading=!0,this.error=null;try{console.log("Fetching chamados...");const s=await a.get("/chamados");return console.log("Chamados response:",s),this.chamados=s.data||[],{success:!0,data:s.data||[]}}catch(s){return this.error=((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erro ao buscar chamados",console.error("Error fetching chamados:",s),console.error("Error response:",s.response),{success:!1,message:this.error}}finally{this.loading=!1}},async fetchDetalheChamados(o){var e,s;this.loading=!0,this.error=null;try{console.log("Fetching chamados...");const r=await a.get("/detalhes_chamado/"+o);return console.log("Detalhe Chamados response:",r),this.detalhe_chamado=r.data||[],{success:!0,data:r.data||[]}}catch(r){return this.error=((s=(e=r.response)==null?void 0:e.data)==null?void 0:s.message)||"Erro ao buscar chamados",console.error("Error fetching chamados:",r),console.error("Error response:",r.response),{success:!1,message:this.error}}finally{this.loading=!1}},async fetchChamadosPorStatus(){var o,e;this.loading=!0,this.error=null;try{console.log("Fetching status...");const s=await a.get("/chamadosPorStatus");return console.log("Status response:",s),this.chamadosPorStatus=s.data||{},console.log("direto da api: ",s.data),{success:!0,data:s.data||{}}}catch(s){return this.error=((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erro ao buscar status",console.error("Error fetching status:",s),console.error("Error response:",s.response),{success:!1,message:this.error}}finally{this.loading=!1}},async fetchChamadosByStatus(o){var e,s;this.loading=!0,this.error=null;try{return{success:!0,data:(await a.get(`/status?valor=${o}`)).data}}catch(r){return this.error=((s=(e=r.response)==null?void 0:e.data)==null?void 0:s.message)||"Erro ao buscar chamados por status",console.error("Error fetching chamados by status:",r),{success:!1,message:this.error}}finally{this.loading=!1}},async fetchTopLocais(){var o,e;this.loading=!0,this.error=null;try{console.log("Fetching locais...");const s=await a.get("/locais");return console.log("Locais response:",s),this.topLocais=s.data||[],{success:!0,data:s.data||[]}}catch(s){return this.error=((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erro ao buscar locais",console.error("Error fetching locais:",s),console.error("Error response:",s.response),{success:!1,message:this.error}}finally{this.loading=!1}},async satSerie(o){var e,s;this.loading=!0,this.error=null;try{console.log("Fetching locais...");const r=await a.get("/sat",{params:{serie:o}});return console.log("Locais response:",r),this.retorno_status=r.data||[],{success:!0,data:r.data||[]}}catch(r){return this.error=((s=(e=r.response)==null?void 0:e.data)==null?void 0:s.message)||"Erro ao buscar locais",console.error("Error fetching locais:",r),console.error("Error response:",r.response),{success:!1,message:this.error}}finally{this.loading=!1}},async meus_chamados(o){var e,s;this.loading=!0,this.error=null;try{console.log("Fetching locais...");const r=await a.post("/insert_usuario",o);return console.log("Locais response:",r),this.retorno_status=r.data||[],{success:!0,data:r.data||[]}}catch(r){return this.error=((s=(e=r.response)==null?void 0:e.data)==null?void 0:s.message)||"Erro ao buscar locais",console.error("Error fetching locais:",r),console.error("Error response:",r.response),{success:!1,message:this.error}}finally{this.loading=!1}}}});export{m as u};
